import{j as e,b as Q,d as B,a as A,B as _,f as I,G as f,g as j,F as N,h as ee,i as C,M as re,k as J,I as K,l as ne,D as g,r as S,m as ae,n as te,o as se,C as le,p as oe,q as k,s as H,R as q,t as M,u as E,v as U,w as D,x as ie,y as ce,z as de,E as z,H as ue,J as xe,L as pe,K as he,N as F}from"./index-BWEcqMhN.js";import{A as Y,a as je,b as me,c as X,d as P,e as T,f as ye,g as ve}from"./AppForm-BsNa3M_s.js";import{P as fe,S as be,H as ge,C as _e,I as Ie}from"./SafetyCheckTwoTone-7KSkY5rD.js";const L=({onSubmit:s,title:l,children:o,back:r=!1,onBack:c=()=>{},skip:n=!1,onSkip:a=()=>{},next:t=!1,finish:d=!1})=>e.jsx("form",{onSubmit:Q.eventPreventDefault(({target:h})=>{let x=new FormData(h);s(x)}),style:{display:"contents"},children:e.jsxs(B,{direction:"column",spacing:2,justifyContent:"start",alignItems:"stretch",sx:{width:"100%",minHeight:"100%"},children:[e.jsx(Z,{title:l,children:o}),e.jsx("div",{style:{flexGrow:1}}),e.jsx(Ae,{back:r,onBack:c,skip:n,onSkip:a,next:t,finish:d})]})}),Ae=({back:s=!1,onBack:l=()=>{},skip:o=!1,onSkip:r=()=>{},next:c=!1,finish:n=!1})=>{const{t:a}=A();return e.jsxs(B,{direction:"row",spacing:2,children:[s&&e.jsx(_,{type:"button",variant:"outlined",color:"error",onClick:l,sx:{px:3},children:a("back")}),o&&e.jsx(_,{type:"button",variant:"contained",color:"primary",onClick:r,sx:{px:3},children:a("skip")}),e.jsx("div",{style:{flexGrow:1}}),c&&e.jsx(_,{type:"submit",variant:"outlined",color:"primary",sx:{px:3},children:a("next")}),n&&e.jsx(_,{type:"submit",variant:"contained",color:"primary",sx:{px:3},children:a("finish")})]})},Z=({title:s,children:l})=>e.jsxs(e.Fragment,{children:[e.jsx(I,{variant:"h4",color:"text.primary",children:s}),e.jsx("div",{style:{width:"100%"},children:e.jsx(f,{container:!0,spacing:2,justifyContent:"start",alignItems:"stretch",children:l})})]}),we=({activeStep:s,nextStep:l,prevStep:o,data:r,pushData:c,createLead:n})=>{const{t:a}=A();return e.jsxs(L,{onSubmit:t=>{let d=c(j.formDataToObj(t));n({name:d.name,phone:d.phone}),l()},title:a("main_person_data"),next:!0,children:[e.jsx(Y,{name:"name",label:a("fullname"),placeholder:a("fullname_hint"),startIcon:e.jsx(N,{}),required:!0,initValue:r==null?void 0:r.name}),e.jsx(je,{name:"phone",label:a("phone_number"),placeholder:a("phone_number_hint"),startIcon:e.jsx(ee,{}),required:!0,initValue:r==null?void 0:r.phone})]})},Ce=({activeStep:s,nextStep:l,prevStep:o,data:r,pushData:c})=>{const{t:n}=A(),a=C(0);return e.jsxs(L,{onSubmit:t=>{c(j.formDataToObj(t)),l()},back:!0,onBack:()=>{o()},next:!0,children:[e.jsx(I,{variant:"h4",gutterBottom:!0,children:n("main_person_data")}),e.jsx(me,{name:"email",label:n("email"),placeholder:n("email_hint"),startIcon:e.jsx(re,{}),required:!1,initValue:r==null?void 0:r.email}),e.jsx(X,{style:{padding:"10px"},name:"birthdate",label:n("birthdate"),startIcon:e.jsx(J,{}),required:!0,initValue:r==null?void 0:r.birthdate}),e.jsx(P,{name:"gender",label:n("gender"),required:!0,startIcon:e.jsx(K,{}),options:[{value:"male",label:n("male")},{value:"female",label:n("female")}],initValue:r==null?void 0:r.gender}),e.jsx("hr",{}),e.jsx(f,{item:!0,xs:12,children:a.value>0&&e.jsxs(e.Fragment,{children:[e.jsx(I,{variant:"h4",gutterBottom:!0,children:n("include_person")}),e.jsx(_,{type:"button",variant:"outlined",color:"primary",sx:{px:3,mx:2},onClick:()=>{a.value=a.value+1},children:n("add")}),e.jsx(_,{type:"button",variant:"outlined",color:"error",sx:{px:3,mx:2},onClick:()=>{a.value>0&&(a.value=a.value-1)},children:n("remove")})]})}),a.value===0&&e.jsx(f,{item:!0,xs:12,children:e.jsxs(I,{variant:"body1",color:"text.primary",textAlign:"center",sx:{width:"100%",py:5},children:[n("add_other_people_desc"),e.jsx("br",{})," ",e.jsx("br",{}),e.jsx(_,{type:"button",variant:"outlined",color:"primary",sx:{px:3},onClick:()=>{a.value=a.value+1},children:n("add")})]})}),a.value>0&&j.generateArray(a.value,t=>e.jsx(Se,{index:t,data:r},`hp-${t}`))]})},Se=({data:s,index:l})=>{const{t:o}=A();return e.jsxs(f,{item:!0,xs:12,children:[e.jsxs(f,{container:!0,children:[e.jsx(Y,{name:"person_name[]",label:o("name"),placeholder:o("name_hint"),startIcon:e.jsx(N,{}),required:!0,cols:{xs:12,sm:6,md:3}}),e.jsx(P,{name:"person_relation[]",label:o("relation"),required:!0,startIcon:e.jsx(ne,{}),options:[{value:"spouse",label:o("spouse")},{value:"child",label:o("children")}],cols:{xs:12,sm:6,md:3}}),e.jsx(X,{style:{padding:"10px"},name:"person_birthdate[]",label:o("birthdate"),startIcon:e.jsx(J,{}),required:!0,cols:{xs:12,sm:6,md:3}}),e.jsx(P,{name:"person_gender[]",label:o("gender"),required:!0,startIcon:e.jsx(K,{}),options:[{value:"male",label:o("male")},{value:"female",label:o("female")}],cols:{xs:12,sm:6,md:3}})]}),e.jsx(g,{})]})},ke=({activeStep:s,nextStep:l,prevStep:o,data:r,pushData:c,deps:n})=>{var v,w;const{t:a,forLocale:t}=A(),d=C(null),h=S.useCallback(()=>n==null?void 0:n.plans_data.find(m=>m.id==="healthLimit"),[n]),x=S.useCallback(()=>{var m;return h()?j.sortArr((m=h())==null?void 0:m.plans_data_values,!1,y=>parseInt(y==null?void 0:y.order_by)):[]},[h]),i=S.useCallback(()=>j.toArray(x(),(m,y)=>({value:y.id,label:y==null?void 0:y[t({ar:"name_alt"},"name")]})),[t,x]);return e.jsxs(L,{onSubmit:m=>{c(j.formDataToObj(m)),l()},title:a("annual_limit"),back:!0,onBack:()=>{o()},next:!0,children:[e.jsx(P,{name:(v=h())==null?void 0:v.id,label:a("annual_limit"),required:!0,startIcon:e.jsx(ae,{}),initValue:r==null?void 0:r[(w=h())==null?void 0:w.id],options:i(),onChange:m=>{d.value=m}}),e.jsx(f,{item:!0,xs:12,sx:{pt:2},children:e.jsx(g,{})}),e.jsx(De,{limit:d.value,deps:n})]})},De=({limit:s,deps:l})=>{const{t:o,forLocale:r}=A(),c=S.useCallback(()=>l==null?void 0:l.plans_data.find(a=>a.id==="healthBenefits"),[l]),n=S.useCallback(()=>{var h;var a=c()?j.sortArr((h=c())==null?void 0:h.plans_data_values,!1,x=>parseInt(x==null?void 0:x.order_by)):[];if(s){var t=j.toArray(j.findAllInArr(l==null?void 0:l.curr_plans_data,(x,i)=>(i==null?void 0:i.plan_data_value_id)===s),(x,i)=>i==null?void 0:i.plan_id),d=j.toArray(j.findAllInArr(l==null?void 0:l.curr_plans_data,(x,i)=>t.includes(i==null?void 0:i.plan_id)),(x,i)=>i==null?void 0:i.plan_data_value_id);a=j.findAllInArr(a,(x,i)=>d.includes(i==null?void 0:i.id))}return a},[l,c,s]);return e.jsx(f,{item:!0,xs:12,sx:{pt:2},children:e.jsx(Z,{title:o("health_benefits"),children:j.toArray(n(),(a,t)=>{var d;return e.jsx(f,{item:!0,xs:6,md:4,children:e.jsx(te,{children:e.jsx(se,{control:e.jsx(le,{name:`${(d=c())==null?void 0:d.id}[]`,value:t.id,...t.always_checked===1?{checked:!0}:{},sx:{"& .MuiSvgIcon-root":{fontSize:28}}}),label:t==null?void 0:t[r({ar:"name_alt"},"name")]})})},`cl-${t.id}`)})})})},Fe=({item:s,onChoosePolicy:l})=>{const{t:o,forLocale:r}=A();return e.jsx(f,{item:!0,xs:12,lg:6,sx:{height:"auto"},children:e.jsx(oe,{sx:{height:"100%",boxShadow:3},children:e.jsxs(B,{direction:"column",sx:{height:"100%"},children:[e.jsxs(k,{sx:{borderColor:"primary.main",fontWeight:"bold"},children:[e.jsx(I,{variant:"h4",color:"primary",name:"plan",children:s==null?void 0:s[r({ar:"plan_name_alt"},"plan_name")]}),e.jsx(I,{variant:"h5",sx:{mt:2,fontWeight:"bold"},color:"secondary.main",name:"plan",children:e.jsx(R,{price:s==null?void 0:s.total,currency:o("egp_year")})})]}),e.jsx(g,{}),e.jsx(k,{sx:{borderColor:"primary.main",fontWeight:"bold",py:0},children:e.jsx(H,{sx:{width:"100%",padding:0},children:j.toArray(s==null?void 0:s.persons,(c,n)=>e.jsxs(q.Fragment,{children:[e.jsxs(M,{alignItems:"flex-start",dense:!0,children:[e.jsx(E,{children:e.jsx(fe,{color:"secondary"})}),e.jsx(U,{primary:n==null?void 0:n.name,secondary:e.jsx(R,{price:n==null?void 0:n.amount,currency:o("egp_year")}),secondaryTypographyProps:{color:"secondary.main"}})]}),e.jsx(g,{variant:"inset",component:"li"})]},`persons-${c}`))})}),e.jsx(g,{}),e.jsxs(k,{sx:{borderColor:"primary.main",fontWeight:"bold",py:0},children:[e.jsx(I,{variant:"body1",color:"primaryT50.main",sx:{py:1},children:o("annual_limit")}),e.jsx(H,{sx:{width:"100%",padding:0},children:j.toArray(s==null?void 0:s.healthLimit,(c,n)=>e.jsxs(q.Fragment,{children:[e.jsxs(M,{alignItems:"flex-start",dense:!0,children:[e.jsx(E,{sx:{mt:0},children:e.jsx(be,{color:"secondary"})}),e.jsx(U,{primary:n==null?void 0:n[r({ar:"name_alt"},"name")]})]}),e.jsx(g,{variant:"inset",component:"li"})]},`limit-${c}`))})]}),e.jsx(g,{}),e.jsx(k,{sx:{borderColor:"primary.main",fontWeight:"bold",py:0},children:e.jsxs(H,{sx:{width:"100%",padding:0},children:[e.jsx(I,{variant:"body1",color:"primaryT50.main",sx:{py:1},children:o("health_benefits")}),j.toArray(s==null?void 0:s.healthBenefits,(c,n)=>e.jsxs(q.Fragment,{children:[e.jsxs(M,{alignItems:"flex-start",dense:!0,children:[e.jsx(E,{children:e.jsx(ge,{color:"secondary"})}),e.jsx(U,{primary:n==null?void 0:n[r({ar:"name_alt"},"name")],secondary:n==null?void 0:n[r({ar:"desc_alt"},"desc")],secondaryTypographyProps:{color:"dark600.main"}})]}),e.jsx(g,{variant:"inset",component:"li"})]},`benefits-${c}`))]})}),e.jsx("div",{style:{flexGrow:1}}),e.jsx(g,{}),e.jsx(k,{children:e.jsxs(B,{direction:"row",spacing:2,children:[e.jsx("div",{style:{flexGrow:1}}),e.jsx(_,{type:"submit",variant:"outlined",color:"primary",sx:{px:3},onClick:()=>l(s),children:o("choose_policy")})]})})]})})})},R=({price:s,currency:l})=>e.jsxs(e.Fragment,{children:[s," ",e.jsx("span",{style:{fontSize:"0.7em"},children:l})]}),Te=({activeStep:s,nextStep:l,prevStep:o,data:r,pushData:c,deps:n,healthReq:a,healthQQ:t})=>{var v,w,m,y,W;const{t:d}=A(),h=C(null),x=C(!1);S.useEffect(()=>{var p=new FormData;if(p.set("user_name",r.name),p.set("phone",r.phone),p.append("name[]",r.name),p.append("age[]",D.parseDate(r.birthdate,"dmy").age),r.person_name)for(let u in r.person_name)p.append("name[]",r.person_name[u]),p.append("age[]",D.parseDate(r.person_birthdate[u],"dmy").age);p.set("healthLimit",r.healthLimit);for(let u in r.healthBenefits)p.append("healthBenefits[]",r.healthBenefits[u]);t.call({bodyData:p,onSuccess:({message:u,data:b})=>{h.value=b==null?void 0:b.UID}})},[]);function i(p){var $,G;var u=new FormData;if(u.set("UID",h.value),u.set("organization_id",p.org_id),u.set("plan_id",p.plan_id),u.set("data_type",p.data_type),u.append("name[]",r.name),u.append("age[]",D.parseDate(r.birthdate,"dmy").age),u.append("gender[]",r.gender),u.append("relation[]","self"),u.append("price[]",($=p.persons)==null?void 0:$[0].amount),r.person_name)for(var b in r.person_name)b=parseInt(b),u.append("name[]",r.person_name[b]),u.append("age[]",D.parseDate(r.person_birthdate[b],"dmy").age),u.append("gender[]",r.person_gender[b]),u.append("relation[]",r.person_relation[b]),u.append("price[]",(G=p.persons)==null?void 0:G[b+1].amount);a.call({bodyData:u,onSuccess:({message:V,data:O})=>{x.value=!0},onError:({message:V,data:O})=>{console.log(V,O)}})}return e.jsxs(L,{onSubmit:p=>{},title:d("list_of_health"),back:!0,onBack:()=>{o()},children:[((w=(v=t==null?void 0:t.value)==null?void 0:v.prices)==null?void 0:w.length)>0&&j.toArray(j.sortArr((m=t==null?void 0:t.value)==null?void 0:m.prices,!0,p=>{var u;return(u=p==null?void 0:p.healthBenefits)==null?void 0:u.length}),(p,u)=>e.jsx(Fe,{item:u,onChoosePolicy:i},`giodfupjsk-${p}`)),((W=(y=t.value)==null?void 0:y.prices)==null?void 0:W.length)===0&&e.jsx(f,{item:!0,xs:12,children:e.jsx(I,{variant:"h5",color:"text.primary",textAlign:"center",sx:{width:"100%",py:10},children:d("empty_health_results")})}),e.jsx(ie,{open:a.waiting||t.waiting,children:e.jsx(ce,{color:"inherit"})}),e.jsx(Be,{open:x.value,icon:e.jsx(_e,{}),content:d("health_request_success"),actions:[Pe({onClick:()=>window.location.href="../",text:d("back"),flex:12})]})]})},Be=({open:s,onClose:l,maxWidth:o="xs",icon:r=e.jsx(Ie,{}),iconColor:c="secondary",content:n,actions:a=[]})=>e.jsxs(de,{open:s,onClose:l,fullWidth:!0,maxWidth:o,PaperProps:{sx:{overflow:"visible",overflowY:"visible"}},children:[e.jsx(z,{sx:{textAlign:"center",mt:-10},children:e.jsx(z,{sx:{bgcolor:"white.main",borderRadius:"100%",width:125,height:125,overflow:"hidden",mx:"auto"},children:S.cloneElement(r,{className:"animate-pulsate-fwd",sx:{width:"100%",height:"100%"},color:c})})}),e.jsx(ue,{children:n,sx:{textAlign:"center"}}),e.jsx(xe,{children:e.jsx(f,{container:!0,spacing:1,children:j.toArray(a,(t,{linkTo:d,onClick:h,close:x,variant:i,color:v,startIcon:w,text:m,flex:y})=>(x&&(d=null,h=l),e.jsx(f,{item:!0,xs:y,children:e.jsx(_,{...d?{component:pe,to:d}:{onClick:h},variant:i,color:v,startIcon:w,children:m,fullWidth:!0,sx:{px:.5}})},`dal-${t}`)))})})]}),Pe=({linkTo:s,onClick:l,close:o=!1,variant:r="outlined",color:c="secondary",startIcon:n,text:a,flex:t=6})=>({linkTo:s,onClick:l,close:o,variant:r,color:c,startIcon:n,text:a,flex:t}),Me=()=>{const{t:s}=A(),l=T(F,"client/health/dependants",{autoCall:!0}),o=T(F,"client/health/quick-quotation2"),r=T(F,"client/health/request"),c=T(F,"client/health/lead"),n=C(!1),a={leadCreated:n.value,createLead:({name:i,phone:v})=>{n.value===!1&&(c.call({bodyData:{user_name:i,phone:v}}),n.value=!0)}},t=C(0),d={activeStep:t.value,nextStep:()=>t.value=t.value+1,prevStep:()=>t.value=t.value-1},h=C({}),x={data:h.value,pushData:i=>{const v={...h.value,...i};return h.value=v,v},setData:i=>h.value=i};return e.jsx(ye,{title:s("health"),icon:e.jsx(he,{}),children:e.jsx(ve,{active:t.value,contents:[e.jsx(we,{...d,...x,...a},"1"),e.jsx(Ce,{...d,...x},"2"),e.jsx(ke,{...d,...x,deps:l.value},"3"),e.jsx(Te,{...d,...x,deps:l.value,healthReq:r,healthQQ:o},"4")]})})};export{Me as default};
