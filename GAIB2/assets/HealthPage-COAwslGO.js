import{j as e,b as Z,d as P,a as I,B as f,f as b,G as _,g as v,F as N,h as Q,i as S,M as ee,k as Y,I as J,l as re,D as w,r as C,m as ne,C as ae,n as A,o as L,R as E,p as M,q as U,s as W,t as k,u as te,v as se,w as le,x as R,y as ie,z as oe,L as ce,E as de,H as T}from"./index-CnGeJRwK.js";import{A as K,a as pe,b as xe,c as X,d as B,C as ue,I as he,e as F,f as me,g as je}from"./AppForm-D_QSIDPZ.js";import{P as ye,S as ve,H as ge}from"./SafetyCheckTwoTone-B4id1PAY.js";const q=({onSubmit:t,title:o,children:s,back:r=!1,onBack:c=()=>{},skip:n=!1,onSkip:a=()=>{},next:l=!1,finish:p=!1})=>e.jsx("form",{onSubmit:Z.eventPreventDefault(({target:x})=>{let u=new FormData(x);t(u)}),style:{display:"contents"},children:e.jsxs(P,{direction:"column",spacing:2,justifyContent:"start",alignItems:"stretch",sx:{width:"100%",minHeight:"100%"},children:[e.jsx(be,{title:o,children:s}),e.jsx("div",{style:{flexGrow:1}}),e.jsx(fe,{back:r,onBack:c,skip:n,onSkip:a,next:l,finish:p})]})}),fe=({back:t=!1,onBack:o=()=>{},skip:s=!1,onSkip:r=()=>{},next:c=!1,finish:n=!1})=>{const{t:a}=I();return e.jsxs(P,{direction:"row",spacing:2,children:[t&&e.jsx(f,{type:"button",variant:"outlined",color:"error",onClick:o,sx:{px:3},children:a("back")}),s&&e.jsx(f,{type:"button",variant:"contained",color:"primary",onClick:r,sx:{px:3},children:a("skip")}),e.jsx("div",{style:{flexGrow:1}}),c&&e.jsx(f,{type:"submit",variant:"outlined",color:"primary",sx:{px:3},children:a("next")}),n&&e.jsx(f,{type:"submit",variant:"contained",color:"primary",sx:{px:3},children:a("finish")})]})},be=({title:t,children:o})=>e.jsxs(e.Fragment,{children:[e.jsx(b,{variant:"h4",color:"text.primary",children:t}),e.jsx("div",{style:{width:"100%"},children:e.jsx(_,{container:!0,spacing:2,justifyContent:"start",alignItems:"stretch",children:o})})]}),_e=({activeStep:t,nextStep:o,prevStep:s,data:r,pushData:c,createLead:n})=>{const{t:a}=I();return e.jsxs(q,{onSubmit:l=>{let p=c(v.formDataToObj(l));n({name:p.name,phone:p.phone}),o()},title:a("main_person_data"),next:!0,children:[e.jsx(K,{name:"name",label:a("fullname"),placeholder:a("fullname_hint"),startIcon:e.jsx(N,{}),required:!0,initValue:r==null?void 0:r.name}),e.jsx(pe,{name:"phone",label:a("phone_number"),placeholder:a("phone_number_hint"),startIcon:e.jsx(Q,{}),required:!0,initValue:r==null?void 0:r.phone})]})},we=({activeStep:t,nextStep:o,prevStep:s,data:r,pushData:c})=>{const{t:n}=I(),a=S(0);return e.jsxs(q,{onSubmit:l=>{c(v.formDataToObj(l)),o()},back:!0,onBack:()=>{s()},next:!0,children:[e.jsx(b,{variant:"h4",gutterBottom:!0,children:n("main_person_data")}),e.jsx(xe,{name:"email",label:n("email"),placeholder:n("email_hint"),startIcon:e.jsx(ee,{}),required:!1,initValue:r==null?void 0:r.email}),e.jsx(X,{style:{padding:"10px"},name:"birthdate",label:n("birthdate"),startIcon:e.jsx(Y,{}),required:!0,initValue:r==null?void 0:r.birthdate}),e.jsx(B,{name:"gender",label:n("gender"),required:!0,startIcon:e.jsx(J,{}),options:[{value:"male",label:n("male")},{value:"female",label:n("female")}],initValue:r==null?void 0:r.gender}),e.jsx("hr",{}),e.jsx(_,{item:!0,xs:12,children:a.value>0&&e.jsxs(e.Fragment,{children:[e.jsx(b,{variant:"h4",gutterBottom:!0,children:n("include_person")}),e.jsx(f,{type:"button",variant:"outlined",color:"primary",sx:{px:3,mx:2},onClick:()=>{a.value=a.value+1},children:n("add")}),e.jsx(f,{type:"button",variant:"outlined",color:"error",sx:{px:3,mx:2},onClick:()=>{a.value>0&&(a.value=a.value-1)},children:n("remove")})]})}),a.value===0&&e.jsx(_,{item:!0,xs:12,children:e.jsxs(b,{variant:"body1",color:"text.primary",textAlign:"center",sx:{width:"100%",py:5},children:[n("add_other_people_desc"),e.jsx("br",{})," ",e.jsx("br",{}),e.jsx(f,{type:"button",variant:"outlined",color:"primary",sx:{px:3},onClick:()=>{a.value=a.value+1},children:n("add")})]})}),a.value>0&&v.generateArray(a.value,l=>e.jsx(Ie,{index:l,data:r},`hp-${l}`))]})},Ie=({data:t,index:o})=>{const{t:s}=I();return e.jsxs(_,{item:!0,xs:12,children:[e.jsxs(_,{container:!0,children:[e.jsx(K,{name:"person_name[]",label:s("name"),placeholder:s("name_hint"),startIcon:e.jsx(N,{}),required:!0,cols:{xs:12,sm:6,md:3}}),e.jsx(B,{name:"person_relation[]",label:s("relation"),required:!0,startIcon:e.jsx(re,{}),options:[{value:"spouse",label:s("spouse")},{value:"child",label:s("children")}],cols:{xs:12,sm:6,md:3}}),e.jsx(X,{style:{padding:"10px"},name:"person_birthdate[]",label:s("birthdate"),startIcon:e.jsx(Y,{}),required:!0,cols:{xs:12,sm:6,md:3}}),e.jsx(B,{name:"person_gender[]",label:s("gender"),required:!0,startIcon:e.jsx(J,{}),options:[{value:"male",label:s("male")},{value:"female",label:s("female")}],cols:{xs:12,sm:6,md:3}})]}),e.jsx(w,{})]})},De=({activeStep:t,nextStep:o,prevStep:s,data:r,pushData:c,deps:n})=>{var y,D;const{t:a,forLocale:l}=I(),p=S(null),x=C.useCallback(()=>n==null?void 0:n.plans_data.find(h=>h.id==="healthLimit"),[n]),u=C.useCallback(()=>{var h;return x()?v.sortArr((h=x())==null?void 0:h.plans_data_values,!1,m=>parseInt(m==null?void 0:m.order_by)):[]},[x]),g=C.useCallback(()=>v.toArray(u(),(h,m)=>({value:m.id,label:m==null?void 0:m[l({ar:"name_alt"},"name")]})),[l,u]);return e.jsx(q,{onSubmit:h=>{c(v.formDataToObj(h)),o()},title:a("annual_limit"),back:!0,onBack:()=>{s()},next:!0,children:e.jsx(B,{name:(y=x())==null?void 0:y.id,label:a("annual_limit"),required:!0,startIcon:e.jsx(ne,{}),initValue:r==null?void 0:r[(D=x())==null?void 0:D.id],options:g(),onChange:h=>{p.value=h}})})},Se=({item:t,onChoosePolicy:o})=>{const{t:s,forLocale:r}=I();return e.jsx(_,{item:!0,xs:12,lg:6,sx:{height:"auto"},children:e.jsx(ae,{sx:{height:"100%",boxShadow:3},children:e.jsxs(P,{direction:"column",sx:{height:"100%"},children:[e.jsxs(A,{sx:{borderColor:"primary.main",fontWeight:"bold"},children:[e.jsx(b,{variant:"h4",color:"primary",name:"plan",children:t==null?void 0:t[r({ar:"plan_name_alt"},"plan_name")]}),e.jsx(b,{variant:"h5",sx:{mt:2,fontWeight:"bold"},color:"secondary.main",name:"plan",children:e.jsx(z,{price:t==null?void 0:t.total,currency:s("egp_year")})})]}),e.jsx(w,{}),e.jsx(A,{sx:{borderColor:"primary.main",fontWeight:"bold",py:0},children:e.jsx(L,{sx:{width:"100%",padding:0},children:v.toArray(t==null?void 0:t.persons,(c,n)=>e.jsxs(E.Fragment,{children:[e.jsxs(M,{alignItems:"flex-start",dense:!0,children:[e.jsx(U,{children:e.jsx(ye,{color:"secondary"})}),e.jsx(W,{primary:n==null?void 0:n.name,secondary:e.jsx(z,{price:n==null?void 0:n.amount,currency:s("egp_year")}),secondaryTypographyProps:{color:"secondary.main"}})]}),e.jsx(w,{variant:"inset",component:"li"})]},`persons-${c}`))})}),e.jsx(w,{}),e.jsxs(A,{sx:{borderColor:"primary.main",fontWeight:"bold",py:0},children:[e.jsx(b,{variant:"body1",color:"primaryT50.main",sx:{py:1},children:s("annual_limit")}),e.jsx(L,{sx:{width:"100%",padding:0},children:v.toArray(t==null?void 0:t.healthLimit,(c,n)=>e.jsxs(E.Fragment,{children:[e.jsxs(M,{alignItems:"flex-start",dense:!0,children:[e.jsx(U,{sx:{mt:0},children:e.jsx(ve,{color:"secondary"})}),e.jsx(W,{primary:n==null?void 0:n[r({ar:"name_alt"},"name")]})]}),e.jsx(w,{variant:"inset",component:"li"})]},`limit-${c}`))})]}),e.jsx(w,{}),e.jsx(A,{sx:{borderColor:"primary.main",fontWeight:"bold",py:0},children:e.jsxs(L,{sx:{width:"100%",padding:0},children:[e.jsx(b,{variant:"body1",color:"primaryT50.main",sx:{py:1},children:s("health_benefits")}),v.toArray(t==null?void 0:t.healthBenefits,(c,n)=>e.jsxs(E.Fragment,{children:[e.jsxs(M,{alignItems:"flex-start",dense:!0,children:[e.jsx(U,{children:e.jsx(ge,{color:"secondary"})}),e.jsx(W,{primary:n==null?void 0:n[r({ar:"name_alt"},"name")],secondary:n==null?void 0:n[r({ar:"desc_alt"},"desc")],secondaryTypographyProps:{color:"dark600.main"}})]}),e.jsx(w,{variant:"inset",component:"li"})]},`benefits-${c}`))]})}),e.jsx("div",{style:{flexGrow:1}}),e.jsx(w,{}),e.jsx(A,{children:e.jsxs(P,{direction:"row",spacing:2,children:[e.jsx("div",{style:{flexGrow:1}}),e.jsx(f,{type:"submit",variant:"outlined",color:"primary",sx:{px:3},onClick:()=>o(t),children:s("choose_policy")})]})})]})})})},z=({price:t,currency:o})=>e.jsxs(e.Fragment,{children:[t," ",e.jsx("span",{style:{fontSize:"0.7em"},children:o})]}),Ae=({activeStep:t,nextStep:o,prevStep:s,data:r,pushData:c,deps:n,healthReq:a,healthQQ:l})=>{var y,D,h,m,G;const{t:p}=I(),x=S(null),u=S(!1);C.useEffect(()=>{var d=new FormData;if(d.set("user_name",r.name),d.set("phone",r.phone),d.append("name[]",r.name),d.append("age[]",k.parseDate(r.birthdate,"dmy").age),r.person_name)for(let i in r.person_name)d.append("name[]",r.person_name[i]),d.append("age[]",k.parseDate(r.person_birthdate[i],"dmy").age);d.set("healthLimit",r.healthLimit),d.append("healthBenefits[]",17),l.call({bodyData:d,onSuccess:({message:i,data:j})=>{x.value=j==null?void 0:j.UID},onError:({message:i,data:j})=>{alert("Error:"+i),console.log(i,j)}})},[]);function g(d){var V,$;var i=new FormData;if(i.set("UID",x.value),i.set("organization_id",d.org_id),i.set("plan_id",d.plan_id),i.set("data_type",d.data_type),i.append("name[]",r.name),i.append("age[]",k.parseDate(r.birthdate,"dmy").age),i.append("gender[]",r.gender),i.append("relation[]","self"),i.append("price[]",(V=d.persons)==null?void 0:V[0].amount),r.person_name)for(var j in r.person_name)j=parseInt(j),i.append("name[]",r.person_name[j]),i.append("age[]",k.parseDate(r.person_birthdate[j],"dmy").age),i.append("gender[]",r.person_gender[j]),i.append("relation[]",r.person_relation[j]),i.append("price[]",($=d.persons)==null?void 0:$[j+1].amount);a.call({bodyData:i,onSuccess:({message:H,data:O})=>{u.value=!0},onError:({message:H,data:O})=>{alert("Error:"+H),console.log(H,O)}})}return e.jsxs(q,{onSubmit:d=>{},title:p("list_of_health"),back:!0,onBack:()=>{s()},children:[((D=(y=l==null?void 0:l.value)==null?void 0:y.prices)==null?void 0:D.length)>0&&v.toArray(v.sortArr((h=l==null?void 0:l.value)==null?void 0:h.prices,!0,d=>{var i;return(i=d==null?void 0:d.healthBenefits)==null?void 0:i.length}),(d,i)=>e.jsx(Se,{item:i,onChoosePolicy:g},`giodfupjsk-${d}`)),((G=(m=l.value)==null?void 0:m.prices)==null?void 0:G.length)===0&&e.jsx(_,{item:!0,xs:12,children:e.jsx(b,{variant:"h5",color:"text.primary",textAlign:"center",sx:{width:"100%",py:10},children:p("empty_results")})}),e.jsx(te,{open:a.waiting||l.waiting,children:e.jsx(se,{color:"inherit"})}),e.jsx(Ce,{open:u.value,icon:e.jsx(ue,{}),content:p("request_success"),actions:[ke({linkTo:"/",text:p("back"),flex:12})]})]})},Ce=({open:t,onClose:o,maxWidth:s="xs",icon:r=e.jsx(he,{}),iconColor:c="secondary",content:n,actions:a=[]})=>e.jsxs(le,{open:t,onClose:o,fullWidth:!0,maxWidth:s,PaperProps:{sx:{overflow:"visible",overflowY:"visible"}},children:[e.jsx(R,{sx:{textAlign:"center",mt:-10},children:e.jsx(R,{sx:{bgcolor:"white.main",borderRadius:"100%",width:125,height:125,overflow:"hidden",mx:"auto"},children:C.cloneElement(r,{className:"animate-pulsate-fwd",sx:{width:"100%",height:"100%"},color:c})})}),e.jsx(ie,{children:n,sx:{textAlign:"center"}}),e.jsx(oe,{children:e.jsx(_,{container:!0,spacing:1,children:v.toArray(a,(l,{linkTo:p,onClick:x,close:u,variant:g,color:y,startIcon:D,text:h,flex:m})=>(u&&(p=null,x=o),e.jsx(_,{item:!0,xs:m,children:e.jsx(f,{...p?{component:ce,to:p}:{onClick:x},variant:g,color:y,startIcon:D,children:h,fullWidth:!0,sx:{px:.5}})},`dal-${l}`)))})})]}),ke=({linkTo:t,onClick:o,close:s=!1,variant:r="outlined",color:c="secondary",startIcon:n,text:a,flex:l=6})=>({linkTo:t,onClick:o,close:s,variant:r,color:c,startIcon:n,text:a,flex:l}),Be=()=>{const{t}=I(),o=F(T,"client/health/dependants",!0),s=F(T,"client/health/quick-quotation2"),r=F(T,"client/health/request"),c=F(T,"client/health/lead"),n=S(!1),a={leadCreated:n.value,createLead:({name:g,phone:y})=>{n.value===!1&&(c.call({bodyData:{user_name:g,phone:y}}),n.value=!0)}},l=S(0),p={activeStep:l.value,nextStep:()=>l.value=l.value+1,prevStep:()=>l.value=l.value-1},x=S({}),u={data:x.value,pushData:g=>{const y={...x.value,...g};return x.value=y,y},setData:g=>x.value=g};return e.jsx(me,{title:t("health"),icon:e.jsx(de,{}),children:e.jsx(je,{active:l.value,contents:[e.jsx(_e,{...p,...u,...a},"1"),e.jsx(we,{...p,...u},"2"),e.jsx(De,{...p,...u,deps:o.value},"3"),e.jsx(Ae,{...p,...u,deps:o.value,healthReq:r,healthQQ:s},"4")]})})};export{Be as default};
