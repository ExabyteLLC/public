import{j as e,L as A,N as T,b as o,ap as W,T as r,G as I,e as B,a as F,a6 as M,af as q,a7 as G,o as p,r as O,D as d,ae as z,aq as H,k as N,d as U,C as $,ar as V,as as J,at as K,au as k,av as Q,S as X,aw as Y}from"./index-D72gc-Hc.js";import{A as C}from"./AppPriceText-CRBV_3XZ.js";import{A as Z}from"./AppProductCardGrid-CJny0lVX.js";import"./MyGrid-DyOJg9hv.js";import"./AppProductFavBtn-DIWj7QFL.js";const ee=({address:i,radio:t=!1,checked:a=!1})=>e.jsx(A,{variant:"outlined",sx:{position:"relative",width:"100%",height:"auto",bgcolor:"white.main",borderColor:"light.main"},square:!0,children:e.jsx(T,{children:e.jsxs(o,{direction:"column",spacing:.5,sx:{px:.75,py:1},children:[e.jsxs(o,{direction:"row",spacing:.5,alignItems:"center",children:[t&&e.jsx(W,{value:i==null?void 0:i.id,checked:a,size:"small",color:"secondary",sx:{p:.5}}),e.jsx(r,{variant:"h6",color:"primary",sx:{fontWeight:"bold",display:"-webkit-box",overflow:"hidden",WebkitBoxOrient:"vertical",WebkitLineClamp:2},children:i==null?void 0:i.name})]}),e.jsx(o,{direction:"row",spacing:.5,children:e.jsx(r,{variant:"subtitle2",color:"primary",children:i==null?void 0:i.telephone1})}),e.jsx(r,{variant:"subtitle1",color:"primary",children:i==null?void 0:i.address1})]})})}),ie=({value:i,title:t,content:a,checked:h=!1})=>e.jsx(A,{variant:"outlined",sx:{position:"relative",width:"100%",height:"auto",bgcolor:"white.main",borderColor:"light.main"},square:!0,children:e.jsx(T,{children:e.jsxs(o,{direction:"column",spacing:.5,sx:{px:.75,py:1},children:[e.jsxs(o,{direction:"row",spacing:.5,alignItems:"center",children:[e.jsx(W,{value:i,checked:h,size:"small",color:"secondary",sx:{p:.5}}),e.jsx(r,{variant:"h6",color:"primary",sx:{fontWeight:"bold",display:"-webkit-box",overflow:"hidden",WebkitBoxOrient:"vertical",WebkitLineClamp:2},children:t})]}),a]})})}),ae=()=>{var b;const i=I(),{t}=B(),{device:a,forDevice:h}=F(),c=a==="mobile",{isClient:j,addresses:_,addressesWaiting:g,checkoutCall:D,checkoutWaiting:L}=M(),S=q(),{cart:P,cartProducts:u,cartValue:R,cartReset:E}=G(),y=Object.keys(P).length===0;p.forEach(u,!1,(s,n,l)=>{var v;if(l===!1)return(!(n!=null&&n.stock)||(n==null?void 0:n.stock)==="0")&&((v=n==null?void 0:n.per_order)==null?void 0:v.toString())==="1"});const x=R(),f=x;O.useLayoutEffect(()=>{(y||!j)&&i(window.history.length>1?-1:"/",{replace:!0})},[y,j]);const w=e.jsxs(o,{direction:"column",spacing:1,width:"100%",py:1,children:[e.jsxs(o,{direction:"column",spacing:.5,children:[f!==x&&e.jsxs(e.Fragment,{children:[e.jsxs(o,{direction:"row",width:"100%",justifyContent:"space-between",children:[e.jsx(r,{children:t("subtotal")}),e.jsx(C,{color:"secondary",price:x,currency:t("currency")})]}),e.jsx(d,{})]}),e.jsxs(o,{direction:"row",width:"100%",justifyContent:"space-between",children:[e.jsx(r,{children:t("total"),sx:{fontWeight:"bold"}}),e.jsx(C,{color:"secondary",price:f,currency:t("currency")})]})]}),e.jsx(z,{loading:L,variant:"contained",color:"secondary",type:"submit",startIcon:e.jsx(H,{}),children:t("complete_order")})]});return e.jsx("form",{onSubmit:N.eventPreventDefault((s,n)=>{let l=new FormData(n);D(l.get("payment_method_id"),l.get("address_id"),()=>{i("/orders",{replace:!0}),E()})}),children:e.jsx(U,{main:!1,header:t("complete_order"),mobileFooter:w,mobileFooterHeight:150,children:e.jsxs($,{fixed:!c,maxWidth:c?"desktop":"laptop",sx:{my:h(2,null,4)},children:[!c&&e.jsx(d,{textAlign:"center",sx:{overflow:"auto",width:"100%",mb:2},children:e.jsx(r,{variant:"h6",color:"primary",children:t("checkout")})}),e.jsxs(o,{direction:"column",spacing:3,children:[e.jsx(V,{severity:"info",color:"warning",children:e.jsx(J,{children:t("shipping_not_included")})}),e.jsxs(o,{direction:"column",spacing:1,children:[e.jsx(m,{title:t("payment_method"),icon:e.jsx(K,{})}),e.jsx(k,{component:o,spacing:1,name:"payment_method_id",children:p.toArray((b=S.data)==null?void 0:b.payments,(s,n)=>e.jsx(ie,{value:n.id,title:t(n.id),checked:s==="0"},`cpl-${s}`))})]}),e.jsxs(o,{direction:"column",spacing:1,children:[e.jsx(m,{title:t("address"),icon:e.jsx(Q,{})}),g&&e.jsx(X,{variant:"rectangular",width:"100%",height:125}),!g&&e.jsx(k,{component:o,spacing:1,name:"address_id",children:p.toArray(_,(s,n)=>e.jsx(ee,{addressId:n.id,address:n,radio:!0,checked:s==="0"},`cal-${s}`))})]}),e.jsxs(o,{direction:"column",spacing:1,children:[e.jsx(m,{title:t("cart"),icon:e.jsx(Y,{})}),e.jsx(Z,{products:u,inCheckout:!0})]}),!c&&e.jsxs(o,{direction:"column",spacing:1,children:[e.jsx(d,{}),w]})]})]})})})},m=({title:i,icon:t})=>e.jsx(d,{textAlign:"left",sx:{overflow:"auto",width:"100%",mb:2},children:e.jsxs(o,{direction:"row",width:"max-content",spacing:1,alignItems:"center",children:[t,e.jsx(r,{color:"primary",children:i,sx:{fontWeight:"bold"}})]})});export{ae as default};
